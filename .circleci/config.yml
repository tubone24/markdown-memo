version: 2
jobs:
  build:
    working_directory: /root
    docker:
      - image: tubone24/algolia-docsearch-base
        environment:
          PIPENV_VENV_IN_PROJECT: true
    steps:
      - run: git clone https://github.com/tubone24/docsearch-scraper.git
      - run: cp config.json docsearch-scraper
      - run: pip3 install -r requirements.txt
      - run: echo "APPLICATION_ID=${APPLICATION_ID}" > docsearch-scraper/.env
      - run: echo "API_KEY=${API_KEY}" >> docsearch-scraper/.env
      - run: cd docsearch-scraper && python3 docsearch run config.json
